Changes in component 'nf-core/xeniumranger/import-segmentation'
Changes in 'xeniumranger/import-segmentation/main.nf':
--- modules/nf-core/xeniumranger/import-segmentation/main.nf
+++ modules/nf-core/xeniumranger/import-segmentation/main.nf
@@ -2,20 +2,20 @@
     tag "$meta.id"
     label 'process_high'
 
-    container "nf-core/xeniumranger:3.0.1"
+    container "nf-core/xeniumranger:3.1.1"
 
     input:
     tuple val(meta), path(xenium_bundle)
-    val(expansion_distance)
     path(coordinate_transform)
     path(nuclei)
     path(cells)
     path(transcript_assignment)
     path(viz_polygons)
+    val(units)
 
     output:
-    tuple val(meta), path("**/outs/**"), emit: outs
-    path "versions.yml", emit: versions
+    tuple val(meta), path("${meta.id}/outs"), emit: bundle
+    path("versions.yml")                    , emit: versions
 
     when:
     task.ext.when == null || task.ext.when
@@ -29,32 +29,33 @@
     def prefix = task.ext.prefix ?: "${meta.id}"
 
     // image based segmentation options
-    def expansion_distance = expansion_distance ? "--expansion-distance=\"${expansion_distance}\"": "" // expansion distance (default - 5, range - 0 - 100)
-    def coordinate_transform = coordinate_transform ? "--coordinate-transform=\"${coordinate_transform}\"": ""
-
+    def coord_transform = coordinate_transform ? "--coordinate-transform=\"${coordinate_transform}\"": ""
     def nuclei_detection = nuclei ? "--nuclei=\"${nuclei}\"": ""
-    def cells = cells ? "--cells=\"${cells}\"": ""
+    def cell_detection = cells ? "--cells=\"${cells}\"": ""
 
     // transcript based segmentation
-    def transcript_assignment = transcript_assignment ? "--transcript-assignment=\"${transcript_assignment}\"": ""
-    def viz_polygons = viz_polygons ? "--viz-polygons=\"${viz_polygons}\"":""
+    def transcript_assign = transcript_assignment ? "--transcript-assignment=\"${transcript_assignment}\"": ""
+    def polygons = viz_polygons ? "--viz-polygons=\"${viz_polygons}\"":""
 
     // shared argument
-    def units = coordinate_transform ? "--units=microns": "--units=pixels"
+    def space = units ? "--units=${units}" : ""
+
+    // conditional args
+    def exp_dist = nuclei ? "--expansion-distance=${params.expansion_distance}": ""
 
     """
     xeniumranger import-segmentation \\
         --id="${prefix}" \\
         --xenium-bundle="${xenium_bundle}" \\
+        ${exp_dist} \\
+        ${coord_transform} \\
+        ${nuclei_detection} \\
+        ${cell_detection} \\
+        ${transcript_assign} \\
+        ${polygons} \\
+        ${space} \\
         --localcores=${task.cpus} \\
         --localmem=${task.memory.toGiga()} \\
-        ${coordinate_transform} \\
-        ${nuclei_detection} \\
-        ${cells} \\
-        ${expansion_distance} \\
-        ${transcript_assignment} \\
-        ${viz_polygons} \\
-        ${units} \\
         ${args}
 
     cat <<-END_VERSIONS > versions.yml

Changes in 'xeniumranger/import-segmentation/meta.yml':
--- modules/nf-core/xeniumranger/import-segmentation/meta.yml
+++ modules/nf-core/xeniumranger/import-segmentation/meta.yml
@@ -62,22 +62,22 @@
         description: |
           Cell boundary polygons (GeoJSON) for visualization from Baysor v0.6. Required if --transcript-assignment argument used. Error if --cells or --nuclei arguments used.
 output:
-  - outs:
+  - bundle:
       - meta:
-          type: file
-          description: Files containing the outputs of Cell Ranger, see official 10X Genomics
-            documentation for a complete list
-          pattern: "${meta.id}/outs/*"
-      - "**/outs/**":
-          type: file
-          description: Files containing the outputs of xenium ranger, see official 10X
-            Genomics documentation for a complete list of outputs
-          pattern: "${meta.id}/outs/*"
+        type: map
+        description: |
+          Groovy Map containing sample information
+          e.g. [ id:'sample' ]
+      - "${meta.id}/outs":
+        type: file
+        description: Files containing the outputs of xenium ranger, see official 10X
+          Genomics documentation for a complete list of outputs
+        pattern: "${meta.id}/outs"
   - versions:
       - versions.yml:
-          type: file
-          description: File containing software versions
-          pattern: "versions.yml"
+        type: file
+        description: File containing software versions
+        pattern: "versions.yml"
 authors:
   - "@khersameesh24"
 maintainers:

'modules/nf-core/xeniumranger/import-segmentation/tests/main.nf.test' is unchanged
'modules/nf-core/xeniumranger/import-segmentation/tests/main.nf.test.snap' is unchanged
'modules/nf-core/xeniumranger/import-segmentation/tests/nextflow.config' is unchanged
'modules/nf-core/xeniumranger/import-segmentation/tests/tags.yml' is unchanged
************************************************************
